<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Profile</title>
        <link rel="stylesheet" href="../assets/css/profilestyle.css">
        <link rel="stylesheet" href="../assets/css/header.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap" rel="stylesheet">
        <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"> 
        <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"> 
        <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    /> 
    </head>
    <body>  
        <div class="content">
          <div class="leftside">
            
            <div class="recent">
              <h2>Recently Played</h2>
              
              <div class="spread">
              <div class="card">
                <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e02b6b3b7f26f0bc0e0197163a0" alt="track poster">
                </div>
                <div class="text">
                  <h3>Track Name</h3>
                  <p>Artist Name</p>
                </div>
        
              </div>

              <div class="spread">
                <div class="card">
                  <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e0282a4489bc3e7f3d1372b3350" alt="track poster">
                  </div>
                  <div class="text">
                    <h3>Track Name</h3>
                    <p>Artist Name</p>
                  </div>
          
                </div>

                <div class="spread">
                  <div class="card">
                    <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e02a88e2419e55cfdf1bf2a2fe2" alt="track poster">
                    </div>
                    <div class="text">
                      <h3>Track Name</h3>
                      <p>Artist Name</p>
                    </div>
            
                  </div>

                  <div class="spread">
                    <div class="card">
                      <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e020d66934f5370419636c78f18" alt="track poster">
                      </div>
                      <div class="text">
                        <h3>Track Name</h3>
                        <p>Artist Name</p>
                      </div>
              
                    </div>

                    <div class="spread">
                      <div class="card">
                        <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e02e3b15ec025f8e74aac8e9393" alt="track poster">
                        </div>
                        <div class="text">
                          <h3>Track Name</h3>
                          <p>Artist Name</p>
                        </div>
                
                      </div>

                      <div class="spread">
                        <div class="card">
                          <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e0239fe640ab73db368eeac0f90" alt="track poster">
                          </div>
                          <div class="text">
                            <h3>Track Name</h3>
                            <p>Artist Name</p>
                          </div>
                  
                        </div>

                        <div class="spread">
                          <div class="card">
                            <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e02905fcfad5d9bd56876735e84" alt="track poster">
                            </div>
                            <div class="text">
                              <h3>Track Name</h3>
                              <p>Artist Name</p>
                            </div>
                    
                          </div>

                          <div class="spread">
                            <div class="card">
                              <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e0282a4489bc3e7f3d1372b3350" alt="track poster">
                              </div>
                              <div class="text">
                                <h3>Track Name</h3>
                                <p>Artist Name</p>
                              </div>
                      
                            </div>
            
                            <div class="spread">
                              <div class="card">
                                <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e02a88e2419e55cfdf1bf2a2fe2" alt="track poster">
                                </div>
                                <div class="text">
                                  <h3>Track Name</h3>
                                  <p>Artist Name</p>
                                </div>
                        
                              </div>
            
                              <div class="spread">
                                <div class="card">
                                  <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e020d66934f5370419636c78f18" alt="track poster">
                                  </div>
                                  <div class="text">
                                    <h3>Track Name</h3>
                                    <p>Artist Name</p>
                                  </div>
                          
                                </div>
            
                                <div class="spread">
                                  <div class="card">
                                    <img loading="lazy"src="https://i.scdn.co/image/ab67616d00001e02e3b15ec025f8e74aac8e9393" alt="track poster">
                                    </div>
                                    <div class="text">
                                      <h3>Track Name</h3>
                                      <p>Artist Name</p>
                                    </div>
                            
                                  </div>
            
            </div>
            <div class="recent">
              <h2>Liked Track</h2>
              <div class="liked">
                

            </div>
            </div>

            
          </div>
          <div class="rightside">
            <h1 id="editpro">Profile</h1>
            <div class="card1">
              <img loading="lazy"src="https://cdn.icon-icons.com/icons2/2643/PNG/512/male_boy_person_people_avatar_icon_159358.png" alt="profile avatar">
              </div> 
              <div class="input" style="width: 82%;">
              <h2>Email</h2>
              <input  type="email" id="email"  disabled>
            </div>
            <div class="input1" style="width: 95%;">
              <h2>Password</h2>
              <input type="password" id="password" class="read" pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*_=+-]).{8,24}$" readonly>
            </div>
            <div class="input"> 
              <h2>Name</h2>
              <input type="text" id="name"class="read" pattern="[a-zA-z0-9]+" readonly>
            </div>
            <div class="input2">
              <h2>Age</h2>
              <input type="text" id="age" disabled>
            </div>
            <div class="input" id="artist" style="position: relative; right: 60px;"> 
              <h2 style="width: 100%;" >ArtistName</h2>
              <input type="text" id="artistname" class="read" style="width: 190px;" readonly>
            </div>
            <div class="btn">
            <button type="button" class="btn1">Edit</button>
            <button type="submit" class="btn2" id="sav" style="display: none;">Save</button>
            <button type="button"  id="logout"class="btn3">Log Out</button>
            <button type="button"  id="delete"class="btn3">Delete</button>
            </div>


          </div>

          
        </div>


        <script src="../assets/js/header.js"></script>
        
        <script>

          function buyerFeat(){
            // Create the parent container div
const secondRightDiv = document.createElement("div");
secondRightDiv.classList.add("secondright");

// Create the recently bought section
const recent1Div = document.createElement("div");
recent1Div.classList.add("recent1");

const recent1Header = document.createElement("h2");
recent1Header.textContent = "Recently Bought";

const spreadDiv1 = document.createElement("div");
spreadDiv1.classList.add("spread");

const cardDiv1 = document.createElement("div");
cardDiv1.classList.add("card");

const img1 = document.createElement("img");
img1.setAttribute("loading", "lazy");
img1.setAttribute("src", "https://cdn5.beatstars.com/...");

const textDiv1 = document.createElement("div");
textDiv1.classList.add("text");

const textHeader1 = document.createElement("h3");
textHeader1.textContent = "Track Name";

const textPara1 = document.createElement("p");
textPara1.textContent = "Artist Name";

const button1 = document.createElement("button");
button1.classList.add("btn-primary");
button1.setAttribute("type", "button");

const cartIcon = document.createElement("i");
cartIcon.classList.add("fa-solid", "fa-cart-shopping");

const buttonText = document.createTextNode("$50");
button1.appendChild(cartIcon);
button1.appendChild(buttonText);

cardDiv1.appendChild(img1);
textDiv1.appendChild(textHeader1);
textDiv1.appendChild(textPara1);
spreadDiv1.appendChild(cardDiv1);
spreadDiv1.appendChild(textDiv1);
spreadDiv1.appendChild(button1);

recent1Div.appendChild(recent1Header);
recent1Div.appendChild(spreadDiv1);

// Create the save later section
const recent2Div = document.createElement("div");
recent2Div.classList.add("recent2");

const recent2Header = document.createElement("h2");
recent2Header.textContent = "Save later";

const spreadDiv2 = document.createElement("div");
spreadDiv2.classList.add("spread");

const cardDiv2 = document.createElement("div");
cardDiv2.classList.add("card");

const img2 = document.createElement("img");
img2.setAttribute("loading", "lazy");
img2.setAttribute("src", "https://i.scdn.co/image/ab67616d00001e02b6b3b7f26f0bc0e0197163a0");

const textDiv2 = document.createElement("div");
textDiv2.classList.add("text1");

const textHeader2 = document.createElement("h3");
textHeader2.textContent = "Track Name";

const textPara2 = document.createElement("p");
textPara2.textContent = "Artist Name";

cardDiv2.appendChild(img2);
textDiv2.appendChild(textHeader2);
textDiv2.appendChild(textPara2);
spreadDiv2.appendChild(cardDiv2);
spreadDiv2.appendChild(textDiv2);

recent2Div.appendChild(recent2Header);
recent2Div.appendChild(spreadDiv2);

// Add everything to the parent container
secondRightDiv.appendChild(recent1Div);
secondRightDiv.appendChild(recent2Div);

// Add the parent container to the document
document.querySelector(".content").append(secondRightDiv)
          }


        function sellerFeat(){


// Get parent element
const parentElem = document.createElement('div');
parentElem.classList.add('secondright')

// Create first child element
const recent1 = document.createElement('div');
recent1.classList.add('recent1');

const h2 = document.createElement('h2');
h2.textContent = 'WITHDRAW MONEY';
recent1.appendChild(h2);

const span = document.createElement('span');
span.classList.add('money');
span.textContent = '$ 50.99 cents';
recent1.appendChild(span);

const button = document.createElement('button');
button.classList.add('withdraw');
button.setAttribute('type', 'button');
button.textContent = 'WITHDRAW';
recent1.appendChild(button);

// Create second child element
const recent2 = document.createElement('div');
recent2.classList.add('recent3');

const h2_2 = document.createElement('h2');
h2_2.textContent = 'Your Tracks';
recent2.appendChild(h2_2);

// Append child elements to parent element
parentElem.appendChild(recent1);
parentElem.appendChild(recent2);

// append to the document
document.querySelector(".content").append(parentElem);
}


        const UserRole = JSON.parse(localStorage.getItem('userRoleC'))

        if(UserRole=="buyer"){
          buyerFeat()
          document.getElementById('artist').style.display="none";
        }
        else{
          sellerFeat()
        }



          const logout = document.querySelector('#logout');
          logout.addEventListener('click',()=>{
            window.location.href = '/index.html';
          })
       
      let userEmail = JSON.parse(localStorage.getItem("userEmail"));
      let user_list=JSON.parse(localStorage.getItem("user_list"));
      let user_liked=JSON.parse(localStorage.getItem("Liked"));

      // filter the liked tracks according to the user 

      let filteredliked = loadData.filter(item => item.UserEmail === userEmail)

function deleteuser(e){
  if (localStorage.getItem("user_list")) {
    if (confirm("Are you sure you want to delete account?")) {
      let users = JSON.parse(localStorage.getItem("user_list"));
      let userID = userEmail
      console.log(userID);

      // Find the index of the user to be deleted
      let userIndex = users.findIndex(user => user.user_email=== userID);

      // If the user is found, remove them from the array
      if (userIndex !== -1) {
        users.splice(userIndex, 1);

        // Convert the updated array back to a string
        let updatedUserList = JSON.stringify(users);

        // Store the updated string in localStorage
        localStorage.setItem("user_list", updatedUserList);

        // Redirect the user to a different page or display a success message
        location.href = "/index.html";
      }
    }
  }
}

      const deleteUser=document.querySelector('#delete').addEventListener('click',deleteuser);

      function findArtist(e){
          return e.user_email==userEmail;

      }

      let artist_data = user_list.find(findArtist);

      document.getElementById("email").value = artist_data['user_email'];
      document.getElementById("password").value = artist_data['user_password'];
      document.getElementById("name").value = artist_data['user_name'];
      document.getElementById("age").value = artist_data['age']+" years old";
      document.getElementById("artistname").value=artist_data["artistName"]
     
     
      function update(e){
                 // getting the updated data from the input field
                 alert("Successfully updated")
                let update_name = document.getElementById("name").value
                let update_password= document.getElementById("password").value
                let update_artist_name = document.getElementById("artistname").value
                // paste the updated data to the correct object
                artist_data['user_name'] = update_name;
                artist_data["user_password"] = update_password;
                artist_data["artistName"] = update_artist_name;
                // again paste it to the
                localStorage.setItem("user_list", JSON.stringify(user_list));             
            }
          

          // edit page
          const sumbit =document.querySelector(".btn2");
          sumbit.addEventListener("click",update)
          sumbit.addEventListener("click",findReadonly1)



      function findReadonly(e){
        
        document.getElementById("password").removeAttribute("readonly");
        document.getElementById("name").removeAttribute("readonly");
        document.getElementById("artistname").removeAttribute("readonly");
        document.querySelector(".btn2").removeAttribute("style");
        document.querySelector(".btn1").setAttribute("style","display:none");


      }

      function findReadonly1(e){
        
        document.getElementById("password").setAttribute("readonly","true");
        document.getElementById("name").setAttribute("readonly","true");
        document.getElementById("artistname").setAttribute("readonly","true");
        document.querySelector(".btn2").setAttribute("style","display:none");
        document.querySelector(".btn1").setAttribute("style","display:inline");
        

      }


      const editThing = document.querySelector(".btn1");
      editThing.addEventListener("click",findReadonly);


      // like track code here first for to loop the cards.
      
for(let i=0;i<user_liked.length;i++){

    track=document.createElement("div");
    track.setAttribute("class","spread");

    imageContainer=document.createElement("div");
    imageContainer.setAttribute("class","card");
    track.append(imageContainer);

    TrackImage=document.createElement("img");
    TrackImage.setAttribute("loading","lazy");
    TrackImage.setAttribute("class","trackPoster")
    TrackImage.setAttribute("src",`https://source.unsplash.com/random/200x200`);
    TrackImage.setAttribute("alt","trackPoster");
    imageContainer.append(TrackImage)

    textContainer=document.createElement("div");
    textContainer.setAttribute("class","text");
    track.append(textContainer);

    trackName=document.createElement("h3")
    trackName.innerText=user_liked[i]["Trackname"];
    textContainer.append(trackName);

    ArtistName=document.createElement("p")
    ArtistName.innerText="artist name";
    textContainer.append(ArtistName);

    


    document.querySelector(".liked").append(track)
    console.log(track)
}




      




        </script>
        <script src="../../assets/js/seller profile.js"></script>
        
    </body>
</html>